<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shops Balance Dashboard</title>

  <!-- External CSS -->
  <link rel="stylesheet" href="styles.css">

  <!-- Netlify Identity Widget -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>

<body>
  <h2>SSP(Line2) Report Balance Summary</h2>

  <!-- Toolbar -->
  <div class="toolbar">
    <select id="leaderFilter">
      <option value="ALL">All Team Leaders</option>
    </select>

    <input type="text" id="searchInput" placeholder="🔍 Search Shop Name...">

    <button id="exportBtn">💾 Export CSV</button>
    <button id="resetBtn" style="background:#888;">🔄 Reset</button>
  </div>

  <!-- Link to open filtered dashboard -->
  <div id="teamDashboardLink"></div>

  <!-- Table Container -->
  <div id="tableContainer">
    <table id="shopTable">
      <thead>
        <tr id="tableHeader"></tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>

  <!-- Pagination Controls -->
  <div id="pagination">
    <button id="prevPage" disabled>⬅ Prev</button>
    <span id="pageInfo" style="margin:0 12px;">Page 1</span>
    <button id="nextPage">Next ➡</button>
  </div>

  <!-- Totals Summary -->
  <div id="totalsRow"></div>

  <!-- Dashboard Logic -->
  <script src="dashboard.js"></script>

  <!-- Netlify Identity Authentication -->
  <script>
    // Initialize Netlify Identity
    netlifyIdentity.init();

    // Redirect to login if user is not logged in
    const user = netlifyIdentity.currentUser();

    if (!user) {
      // Option 1: Redirect to Netlify Identity login page
      window.location.href = '/.netlify/identity';

      // Option 2: Uncomment to show a login modal instead
      // netlifyIdentity.open();
    }
  </script>
</body>
</html>
